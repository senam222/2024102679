<!DOCTYPE html>
<html lang="ko">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>실시간 환율 변환 지도</title>
 <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
 <style>
 body {
 font-family: 'Arial', sans-serif;
 margin: 0;
 padding: 20px;
 background-color: #f5f5f5;
 }

 .container {
 max-width: 1400px;
 margin: 0 auto;
 background: white;
 border-radius: 10px;
 box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
 overflow: hidden;
 }

 .header {
 background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
 color: white;
 padding: 20px;
 text-align: center;
 }

 .header h1 {
 margin: 0;
 font-size: 28px;
 }

 .header p {
 margin: 10px 0 0 0;
 opacity: 0.9;
 }

 .map-container {
 position: relative;
 padding: 20px;
 min-height: 600px;
 }

 #geochart {
 width: 100%;
 height: 600px;
 }

 .currency-input {
 position: absolute;
 background: white;
 border: 2px solid #e2e8f0;
 border-radius: 6px;
 padding: 4px;
 width: 70px;
 box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
 z-index: 1000;
 transition: all 0.3s ease;
 }

 .currency-input.active {
 border-color: #f56500;
 box-shadow: 0 4px 12px rgba(245, 101, 0, 0.3);
 transform: scale(1.1);
 background: #fff7ed;
 }

 .currency-input.target {
 border-color: #48bb78;
 box-shadow: 0 2px 8px rgba(72, 187, 120, 0.2);
 background: #f0fff4;
 }

 .currency-input.hover {
 border-color: #9f7aea;
 box-shadow: 0 3px 10px rgba(159, 122, 234, 0.3);
 transform: scale(1.05);
 background: #faf5ff;
 }

 .currency-input .country-label {
 font-size: 9px;
 font-weight: bold;
 color: #667eea;
 margin-bottom: 2px;
 text-align: center;
 line-height: 1;
 }

 .currency-input input {
 width: 100%;
 padding: 2px;
 border: 1px solid #e2e8f0;
 border-radius: 3px;
 font-size: 10px;
 text-align: center;
 box-sizing: border-box;
 }

 .currency-input input:focus {
 outline: none;
 border-color: #667eea;
 box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);
 }

 .currency-input .currency-code {
 font-size: 7px;
 color: #718096;
 text-align: center;
 margin-top: 1px;
 line-height: 1;
 }

 .status-panel {
 position: absolute;
 top: 20px;
 left: 20px;
 background: white;
 border: 2px solid #48bb78;
 border-radius: 8px;
 padding: 15px;
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
 z-index: 1001;
 min-width: 200px;
 }

 .status-panel h4 {
 margin: 0 0 10px 0;
 color: #48bb78;
 font-size: 14px;
 }

 .api-status {
 font-size: 11px;
 color: #666;
 margin-top: 8px;
 padding: 5px;
 background: #f8f9fa;
 border-radius: 4px;
 }

 .loading { color: #f56500; }
 .success { color: #38a169; }
 .error { color: #e53e3e; }

 .instruction {
 margin-top: 20px;
 padding: 15px;
 background: #e8f2ff;
 border-radius: 5px;
 text-align: center;
 color: #2c5282;
 }
 </style>
</head>
<body>
 <div class="container">
 <div class="header">
 <h1>🌍 실시간 다국가 환율 변환</h1>
 <p>한 국가에 금액을 입력하면 모든 국가의 환율이 자동 계산됩니다</p>
 </div>

 <div class="map-container">
 <div id="geochart"></div>

 <div class="status-panel">
 <h4>💡 사용법</h4>
 <div style="font-size: 12px; line-height: 1.4;">
 텍스트박스를 클릭하고<br>
 금액을 입력해보세요!
 </div>
 <div class="api-status" id="apiStatus">
 🔄 실시간 환율 로딩 중...
 </div>
 </div>

 <div class="instruction">
 <strong>💰 실시간 환율 변환:</strong>
 한 국가에 금액을 입력하면 다른 모든 국가에 자동으로 환전된 금액이 표시됩니다
 <br><small style="color: #666; margin-top: 5px; display: block;">
 🔄 환율은 5분마다 자동 업데이트됩니다
 </small>
 </div>
 </div>
 </div>

 <script type="text/javascript">
 // 국가별 정보 및 색상 (완전히 수정된 버전)
 const countryData = {
 'US': {
 name: '미국', currency: 'USD', symbol: '$',
 position: { top: '45%', left: '18%' }, color: 1
 },
 'KR': {
 name: '한국', currency: 'KRW', symbol: '₩',
 position: { top: '35%', left: '82%' }, color: 2
 },
 'JP': {
 name: '일본', currency: 'JPY', symbol: '¥',
 position: { top: '30%', left: '87%' }, color: 3
 },
 'CN': {
 name: '중국', currency: 'CNY', symbol: '¥',
 position: { top: '38%', left: '72%' }, color: 4
 },
 'GB': {
 name: '영국', currency: 'GBP', symbol: '£',
 position: { top: '22%', left: '48%' }, color: 5
 },
 'DE': {
 name: '독일', currency: 'EUR', symbol: '€',
 position: { top: '25%', left: '52%' }, color: 6
 },
 'FR': {
 name: '프랑스', currency: 'EUR', symbol: '€',
 position: { top: '32%', left: '50%' }, color: 7
 },
 'CA': {
 name: '캐나다', currency: 'CAD', symbol: 'C$',
 position: { top: '30%', left: '22%' }, color: 8
 },
 'AU': {
 name: '호주', currency: 'AUD', symbol: 'A$',
 position: { top: '70%', left: '80%' }, color: 9
 },
 'IN': {
 name: '인도', currency: 'INR', symbol: '₹',
 position: { top: '45%', left: '68%' }, color: 10
 },
 'BR': {
 name: '브라질', currency: 'BRL', symbol: 'R$',
 position: { top: '55%', left: '30%' }, color: 11
 },
 'RU': {
 name: '러시아', currency: 'RUB', symbol: '₽',
 position: { top: '20%', left: '65%' }, color: 12
 }
 };

 // 환율 데이터 (실시간 업데이트됨)
 let exchangeRates = {
 'USD': 1330, 'KRW': 1, 'JPY': 9.8, 'CNY': 185,
 'GBP': 1680, 'EUR': 1450, 'CAD': 980, 'AUD': 890,
 'INR': 16, 'BRL': 270, 'RUB': 14
 };

 let activeCountry = null;

 // Google Charts 로드
 google.charts.load('current', {
 'packages': ['geochart'],
 'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
 });
 google.charts.setOnLoadCallback(initializeMap);

 function initializeMap() {
 drawMap();
 createCurrencyInputs();
 startRateUpdates();
 }

 function drawMap() {
 const data = google.visualization.arrayToDataTable([
 ['Country', 'Value'],
 ...Object.entries(countryData).map(([code, info]) => [code, info.color])
 ]);

 const options = {
 legend: 'none',
 colorAxis: {
 legend: { position: 'none' },
 colors: [
 '#FF4444', // 빨간색
 '#44FF44', // 초록색
 '#4444FF', // 파란색
 '#FFFF44', // 노란색
 '#FF44FF', // 마젠타
 '#44FFFF', // 청록색
 '#FF8844', // 주황색
 '#8844FF', // 보라색
 '#FF4488', // 핑크색
 '#88FF44', // 라임색
 '#4488FF', // 하늘색
 '#FF8888' // 연빨간색
 ]
 },
 backgroundColor: '#f8fafc',
 datalessRegionColor: '#f1f5f9',
 defaultColor: '#e2e8f0',
 width: '100%',
 height: '600',
 tooltip: { trigger: 'none' }
 };

 const chart = new google.visualization.GeoChart(document.getElementById('geochart'));

 // 지도 국가에 마우스 호버 이벤트 추가
 google.visualization.events.addListener(chart, 'onmouseover', function(e) {
 const countries = Object.keys(countryData);
 if (e.row !== null && e.row < countries.length) {
 const countryCode = countries[e.row];
 highlightFromMap(countryCode);
 }
 });

 google.visualization.events.addListener(chart, 'onmouseout', function(e) {
 clearMapHighlight();
 });

 chart.draw(data, options);
 }

 function createCurrencyInputs() {
 const mapContainer = document.querySelector('.map-container');

 Object.entries(countryData).forEach(([code, info]) => {
 const inputDiv = document.createElement('div');
 inputDiv.className = 'currency-input';
 inputDiv.id = `container-${code}`;
 inputDiv.style.top = info.position.top;
 inputDiv.style.left = info.position.left;
 inputDiv.innerHTML = `
 <div class="country-label">${info.name}</div>
 <input type="number"
 id="input-${code}"
 placeholder="0"
 step="0.01"
 oninput="convertAllCurrencies('${code}', this.value)"
 onfocus="highlightCountry('${code}')"
 onblur="clearHighlight()">
 <div class="currency-code">${info.currency}</div>
 `;
 mapContainer.appendChild(inputDiv);
 });
 }

 function highlightFromMap(countryCode) {
 // 기존 호버 효과 제거
 clearMapHighlight();

 // 해당 국가 텍스트박스 호버 효과
 const container = document.getElementById(`container-${countryCode}`);
 if (container) {
 container.classList.add('hover');
 }
 }

 function clearMapHighlight() {
 // 포커스된 국가가 아닌 경우만 호버 효과 제거
 Object.keys(countryData).forEach(code => {
 const container = document.getElementById(`container-${code}`);
 if (container && activeCountry !== code) {
 container.classList.remove('hover');
 }
 });
 }

 function highlightCountry(countryCode) {
 clearHighlight();
 clearMapHighlight();
 activeCountry = countryCode;

 // 활성 국가 강조
 document.getElementById(`container-${countryCode}`).classList.add('active');

 // 다른 국가들을 대상으로 표시
 Object.keys(countryData).forEach(code => {
 if (code !== countryCode) {
 document.getElementById(`container-${code}`).classList.add('target');
 }
 });
 }

 function clearHighlight() {
 Object.keys(countryData).forEach(code => {
 const container = document.getElementById(`container-${code}`);
 container.classList.remove('active', 'target', 'hover');
 });
 activeCountry = null;
 }

 function convertAllCurrencies(sourceCountry, sourceAmount) {
 const amount = parseFloat(sourceAmount);

 if (!sourceAmount || isNaN(amount) || amount <= 0) {
 Object.keys(countryData).forEach(code => {
 if (code !== sourceCountry) {
 document.getElementById(`input-${code}`).value = '';
 }
 });
 return;
 }

 const sourceCurrency = countryData[sourceCountry].currency;
 const sourceRate = exchangeRates[sourceCurrency];
 const amountInKRW = amount * sourceRate;

 Object.entries(countryData).forEach(([code, info]) => {
 if (code !== sourceCountry) {
 const targetRate = exchangeRates[info.currency];
 const convertedAmount = amountInKRW / targetRate;

 let decimalPlaces = 2;
 if (info.currency === 'JPY' || info.currency === 'KRW') {
 decimalPlaces = 0;
 } else if (info.currency === 'INR' || info.currency === 'RUB') {
 decimalPlaces = 1;
 }

 document.getElementById(`input-${code}`).value = convertedAmount.toFixed(decimalPlaces);
 }
 });
 }

 // 실시간 환율 API
 async function fetchRealTimeRates() {
 const statusElement = document.getElementById('apiStatus');
 statusElement.innerHTML = '🔄 환율 업데이트 중...';
 statusElement.className = 'api-status loading';

 try {
 // ExchangeRate-API 사용
 const response = await fetch('https://api.exchangerate-api.com/v4/latest/KRW');

 if (!response.ok) throw new Error('API 호출 실패');

 const data = await response.json();

 if (data.rates) {
 const supportedCurrencies = ['USD', 'JPY', 'CNY', 'GBP', 'EUR', 'CAD', 'AUD', 'INR', 'BRL', 'RUB'];

 supportedCurrencies.forEach(currency => {
 if (data.rates[currency]) {
 exchangeRates[currency] = 1 / data.rates[currency];
 }
 });

 const now = new Date();
 statusElement.innerHTML = `✅ 환율 업데이트 완료<br><small>시간: ${now.toLocaleTimeString('ko-KR')}</small>`;
 statusElement.className = 'api-status success';
 } else {
 throw new Error('환율 데이터 없음');
 }

 } catch (error) {
 console.error('환율 업데이트 실패:', error);
 statusElement.innerHTML = `⚠️ 환율 업데이트 실패<br><small>기본 환율 사용</small>`;
 statusElement.className = 'api-status error';
 }
 }

 function startRateUpdates() {
 fetchRealTimeRates();
 setInterval(fetchRealTimeRates, 5 * 60 * 1000); // 5분마다
 }
 </script>
</body>
</html
